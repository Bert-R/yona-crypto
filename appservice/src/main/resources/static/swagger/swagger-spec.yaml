swagger: '2.0'
info:
  title: Yona app service API
  description: The API of the service backing the Yona app
  version: 1.0.0
schemes:
  - http
basePath: /
produces:
  - application/json
paths:
  /users/:
    post:
      summary: Add a new user
      description: Registers a new user
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
        - name: overwriteUserConfirmationCode
          in: query
          description: Pass the confirmation code here when trying to overwrite the account in case of a device loss
          required: false
          type: string
        - in: body
          name: body
          description: New user
          required: true
          schema:
            $ref: '#/definitions/PostPutUser'
      tags:
        - User
      responses:
        '201':
          description: The created user
          schema:
            $ref: '#/definitions/UserWithPrivateData'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/UserWithPrivateData'
  '/users/{id}':
    parameters:
      - name: id
        in: path
        description: The ID of the user
        required: true
        type: string
    get:
      summary: Get a user
      description: Fetches the user identified by the given ID
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: false
          type: string
        - name: includePrivateData
          in: query
          description: Pass true to fetch the private data of the user
          required: false
          type: boolean
      tags:
        - User
      responses:
        '200':
          description: The requested user. The set of returned properties depends on the query parameter includePrivateData.
          schema:
            $ref: '#/definitions/UserWithPrivateData'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    put:
      summary: Update a user
      description: Fetches the user identified by the given ID
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
        - in: body
          name: body
          description: New user
          required: true
          schema:
            $ref: '#/definitions/PostPutUser'
      tags:
        - User
      responses:
        '200':
          description: The requested user
          schema:
            $ref: '#/definitions/PostPutUser'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      summary: Delete a user
      description: Deletes the user with the given ID
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
      tags:
        - User
      responses:
        '200':
          description: The user is deleted.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{id}/confirmMobileNumber':
    parameters:
      - name: id
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    post:
      summary: Confirm mobile number
      description: Post the code to confirm the mobile number of the user. This number is sent to the user by SMS.
      parameters:
        - in: body
          name: body
          description: Message with confirmation code
          required: true
          schema:
            type: object
            required:
              - code
            properties:
              code:
                type: string
      tags:
        - User
      responses:
        '201':
          description: The updated user
          schema:
            $ref: '#/definitions/UserWithPrivateData'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{id}/newDeviceRequest':
    parameters:
      - name: id
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    put:
      summary: Request to add a new device
      description: This stores an encrypted copy of the users device key on the server, for a limited period of time.
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
        - in: body
          name: body
          description: Message with user secret. The device password will be encrypted with this secret and stored for a limited period of time.
          required: true
          schema:
            type: object
            required:
              - userSecret
            properties:
              userSecret:
                type: string
      tags:
        - User
      responses:
        '200':
          description: The new device request
          schema:
            # TODO: why do we return this? The app (on this device) cannot use it, right?
            $ref: '#/definitions/NewDeviceRequest'
        '201':
          description: The newly added new device request
          schema:
            # TODO: why do we return this? The app (on this device) cannot use it, right?
            $ref: '#/definitions/NewDeviceRequest'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    get:
      summary: Get new device request
      description: If the user secret is given, the returned resource contains the device password. The app can check the presence of a new device request by omitting the user secret. In that case, a blank new device request is returned.
      parameters:
        - name: userSecret
          in: header
          description: The password used to encrypt the device key
          required: false
          type: string
      tags:
        - User
      responses:
        '200':
          description: The new device request
          schema:
            $ref: '#/definitions/NewDeviceRequest'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      summary: Delete new device request
      description: Deletes the new device request
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
      tags:
        - User
      responses:
        '200':
          description: The new device request is deleted.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/goals/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    post:
      summary: Add a new goal
      description: Add a new goal to an existing user
      parameters:
        - in: body
          name: body
          description: New goal
          required: true
          schema:
            $ref: '#/definitions/PostPutGoal'
      tags:
        - Goal
      responses:
        '201':
          description: The created goal
          schema:
            $ref: '#/definitions/Goal'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    get:
      summary: Get all goals
      description: Fetches all goals of the user with the given ID
      tags:
        - Goal
      responses:
        '200':
          description: All goals of this user.
          schema:
            type: array
            items: 
              $ref: '#/definitions/Goal'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/goals/{id}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: id
        in: path
        description: The ID of the goal
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get a goal
      description: Fetches the goal identified by the given ID
      tags:
        - Goal
      responses:
        '200':
          description: The requested goal.
          schema:
            $ref: '#/definitions/Goal'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      summary: Delete goal
      description: Deletes this goal
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
      tags:
        - Goal
      responses:
        '200':
          description: The goal is deleted.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/buddies/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    post:
      summary: Add a new buddy
      description: Add a new buddy to an existing user
      parameters:
        - in: body
          name: body
          description: New buddy
          required: true
          schema:
            $ref: '#/definitions/PostPutBuddy'
      tags:
        - Buddy
      responses:
        '201':
          description: The created buddy
          schema:
            $ref: '#/definitions/Buddy'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    get:
      summary: Get all buddies
      description: Fetches all buddies of the user with the given ID
      tags:
        - Buddy
      responses:
        '200':
          description: All buddies of this user.
          schema:
            type: array
            items: 
              $ref: '#/definitions/Buddy'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/buddies/{id}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: id
        in: path
        description: The ID of the buddy
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get a buddy
      description: Fetches the buddy identified by the given ID
      tags:
        - Buddy
      responses:
        '200':
          description: The requested buddy.
          schema:
            $ref: '#/definitions/Buddy'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
    delete:
      summary: Delete buddy
      description: Deletes this buddy
      parameters:
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
      tags:
        - Buddy
      responses:
        '200':
          description: The new buddy is deleted.
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/users/{userID}/messages/':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get messages
      description: Fetches all messages of the user with the given ID
      parameters:
        - name: size
          in: query
          description: The number of elements to be fetched
          required: false
          default: 10
          type: number
        - name: page
          in: query
          description: The page to be fetched
          required: false
          default: 10
          type: number
      tags:
        - Message
      responses:
        '200':
          description: Messages of this user.
          schema:
            $ref: '#/definitions/PagedMessages'
  '/users/{userID}/messages/{id}':
    parameters:
      - name: userID
        in: path
        description: The ID of the user
        required: true
        type: string
      - name: id
        in: path
        description: The ID of the message
        required: true
        type: string
      - name: Yona-Password
        in: header
        description: The device password
        required: true
        type: string
    get:
      summary: Get a message
      description: Fetches all messages of the user with the given ID
      tags:
        - Message
      responses:
        '200':
          description: Messages of this user.
          schema:
            $ref: '#/definitions/Message'
    delete:
      summary: Delete a message
      description: Deletes the message with the given ID
      tags:
        - Message
      responses:
        '200':
          description: Messages of this user.
  '/users/{userID}/messages/{id}/{messageAction}':
    post:
      summary: Act on a message
      description: Perform the Process action on the message with the given ID
      parameters:
        - name: userID
          in: path
          description: The ID of the user
          required: true
          type: string
        - name: id
          in: path
          description: The ID of the message
          required: true
          type: string
        - name: messageAction
          in: path
          description: The action to be performed on the message
          required: true
          type: string
        - name: Yona-Password
          in: header
          description: The device password
          required: true
          type: string
        - in: body
          name: body
          description: New user
          required: true
          schema:
            $ref: '#/definitions/MessageAction'
      tags:
        - Message
      responses:
        '201':
          description: The action response
          schema:
            $ref: '#/definitions/MessageAction'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/activityCategories/':
    get:
      summary: Get all activity categories
      description: Get the set of defined activity categories
      tags:
        - Activity categories
      responses:
        '200':
          description: The activity categories.
          schema:
            type: array
            items: 
              $ref: '#/definitions/ActivityCategory'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/activityCategories/{id}':
    get:
      summary: Get an activity category
      description: Fetches the activity category identified by the given ID
      parameters:
        - name: id
          in: path
          description: The ID of the activity category
          required: true
          type: string
      tags:
        - Activity categories
      responses:
        '200':
          description: The requested activity category.
          schema:
            $ref: '#/definitions/ActivityCategory'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
  '/admin/requestUserOverwrite/':
    post:
      summary: Request user overwrite
      description: Request to overwrite the user account after a device loss
      parameters:
        - in: body
          name: body
          description: User overwrite request
          required: true
          schema:
            $ref: '#/definitions/UserOverwriteRequest'
      tags:
        - Admin
      responses:
        '200':
          description: The status of the overwrite request
          schema:
            $ref: '#/definitions/UserOverwriteResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'
definitions:
  Curies:
    type: object
    properties:
      curies:
        type: array
        description: A set of curies (Compact URIs). For Yona, there is just one curie.
        items:
          type: object
          properties:
            name:
              type: string
              description: The curie name. The prefix of a curied link will be used to find the curie by name
              example: yona
            href:
              type: string
              description: The URL corresponding to this curie.
              example: http://dev.yona.nu/rels/{rel}
            templated:
              type: string
              format: boolean
              description: Whether this curie is templated (always true for Yona).
              example: true
          required:
            - name
            - href
            - templated
  SelfLink:
    type: object
    properties:
      self:
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Identifies this same resource
    required:
      - self
  EditLink:
    type: object
    properties:
      edit:
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Through this link, this resource can be edited or deleted. Note that this link is not always present. Certain resources can never be edited. Some others can only be edited or deleted in a specific state. Unprocessed messages for example cannot be deleted.
  RelatedLink:
    type: object
    properties:
      related:
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Refers to a related resource
  UserLink:
    type: object
    properties:
      "yona:user":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: The related user
  AcceptLink:
    type: object
    properties:
      "yona:accept":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Post a MessageAction with a message on this link to accept this request
  RejectLink:
    type: object
    properties:
      "yona:reject":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Post a MessageAction with a message on this link to reject this request
  ProcessLink:
    type: object
    properties:
      "yona:process":
        type: object
        required:
          - href
        properties:
          href:
            type: string
            description: Post an empty MessageAction on this link to process this response
  BaseUser:
    type: object
    properties:
      firstName:
        type: string
        description: First name.
        example: Richard
      lastName:
        type: string
        description: Last name.
        example: Quin
      mobileNumber:
        type: string
        description: 'Mobile number, unique among all users.'
        example: "+31612345678"
    required:
    - firstName
    - lastName
    - mobileNumber
  PrivateUserDataNoVPN:
    type: object
    properties:
      nickname:
        type: string
        description: Nickname known among buddies. Private data.
        example: RQ
      devices:
        type: array
        items:
          type: string
          example: "Nexus 6"
        description: Devices registered with Yona. Private data.
    required:
    - nickname
    - devices
  PrivateUserData:
    allOf:
      - $ref: '#/definitions/PrivateUserDataNoVPN'
    properties:
      vpnProfile:
        $ref: '#/definitions/VPNProfile'
    required:
    - vpnProfile
  PostPutUser:
    allOf:
      - $ref: '#/definitions/BaseUser'
      - $ref: '#/definitions/PrivateUserDataNoVPN'
  UserWithPrivateData:
    allOf:
      - $ref: '#/definitions/BaseUser'
      - $ref: '#/definitions/PrivateUserData'
    properties:
      _embedded:
        type: object
        properties:
          "yona:goals":
            type: object
            description: The goals of this user. Private data.
            properties:
              _embedded:
                type: object
                properties:
                  "yona:goals":
                    type: array
                    items:
                      $ref: "#/definitions/Goal"
              links:
                allOf:
                  - $ref: '#/definitions/SelfLink'
                  - $ref: '#/definitions/EditLink'
          "yona:buddies":
            type: object
            description: The buddies of this user. Private data.
            properties:
              _embedded:
                type: object
                properties:
                  "yona:buddies":
                    type: array
                    items:
                      $ref: "#/definitions/Buddy"
              links:
                allOf:
                  - $ref: '#/definitions/SelfLink'
                  - $ref: '#/definitions/EditLink'
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/EditLink'
        properties:
          # TODO add messages link
          # TODO add buddies link
          "yona:confirmMobileNumber":
            type: object
            required:
              - href
            properties:
              href:
                type: string
                description: If this link is present, the mobile number of the user must be confirmed by posting the confirmation to this URL.
    required:
      - _embedded
      - _links
  UserWithOnlyPublicData:
    allOf:
      - $ref: '#/definitions/BaseUser'
    properties:
      _links:
        allOf:
          - $ref: '#/definitions/SelfLink'
    required:
      - _links
  PostPutGoal:
    type: object
    discriminator: "@type"
    properties:
      "@type":
        type: string
        enum:
        - BudgetGoal
        - TimeZoneGoal
        description: The type of goal
      activityCategoryName:
        type: string
        description: The actity category of this goal
        example: Gambling
      maxDuration:
        type: integer
        description: The budget (duration) for this goal, if the goal is a budget goal
        example: 0
      zones:
        type: array
        items:
          type: string
          example: "8:00-17:00"
        description: The zones for this goal, if the goal is a time zone goal
    required:
    - "@type"
    - activityCategoryName
  Goal:
    allOf:
      - $ref: '#/definitions/PostPutGoal'
    properties:
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/EditLink'
    required:
      - _links
  VPNProfile:
    type: object
    description: VPN profile. Private data.
    properties:
      vpnLoginID:
        type: string
        description: The user ID to log in to the VPN
        example: c4b139c0-53ea-4a19-8b60-a6d526bb2277
      vpnPassword:
        type: string
        description: The password to log in to the VPN
        example: UA1ksZCptapsDRdg1Qrn2bDvKdfl8sDd
      openVPNProfile:
        type: string
        description: The OpenVPN profile to be installed on the device. Newlines are specified as \n.
        example: "client \ndev tun \nresolv-retry infinite \nnobind \npersist-key \npersist-tun \n<ca> \n-----BEGIN CERTIFICATE-----..."
    required:
      - vpnLoginID
      - vpnPassword
      - openVPNProfile
  BuddyStatus:
    type: string
    description: The status of this buddy or buddy connect request
    enum:
    - NOT_REQUESTED
    - REQUESTED
    - ACCEPTED
    - REJECTED
  PostPutBuddy:
    type: object
    properties:
      nickname:
        type: string
        description: Nickname of this buddy
        example: RQ
      sendingStatus:
        $ref: '#/definitions/BuddyStatus'
        example: REQUESTED
      receivingStatus:
        $ref: '#/definitions/BuddyStatus'
        example: REQUESTED
      _embedded:
        type: object
        properties:
          "yona:user":
              $ref: "#/definitions/UserWithOnlyPublicData"
    required:
      - nickname
      - sendingStatus
      - receivingStatus
  Buddy:
    allOf:
      - $ref: '#/definitions/PostPutBuddy'
    properties:
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/EditLink'
    required:
      - _links
  NewDeviceRequest:
    type: object
    properties:
      userPassword:
        type: string
        description: The device key. If the user secret was not provided in the request, this property will be blank.
        example: Only I know this
      isUpdatingExistingRequest:
        # TODO: is this of relevance for the app? If not, we should tag it with @JsonIgnore
        type: boolean
        description: True when an existing device request has been updated
        example: false
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/EditLink'
    required:
      - userPassword
      - isUpdatingExistingRequest
      - _links
  ActivityCategory:
    type: object
    properties:
      name:
        type: string
        description: The name of this activity category
        example: Gambling
      isMandatory:
        type: boolean
        description: True when this activity category is mandatory for all users. The server will add a goal for such activity categories upon sign up of a user
        example: true
      applications:
        type: array
        items:
          type: string
        description: The set of apps linked to this activity category
        example:
          - Roulette
          - Blackjack
      smoothwallCategories:
        # TODO: Is this relevant to the app? If not, we should remove it from the DTO.
        type: array
        items:
          type: string
        description: The set of Smootwall categories linked to this activity category
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
    required:
      - name
      - isMandatory
      - applications
      - smoothwallCategories
      - _links
  Message:
    type: object
    discriminator: "@type"
    properties:
      "@type":
        type: string
        enum:
        - BuddyConnectRequestMessage
        - BuddyConnectResponseMessage
        - BuddyDisconnectMessage
        - GoalConflictMessage
        - DisclosureRequestMessage
        - DisclosureResponseMessage
      creationTime:
        type: string
        format: dateTime
        description: The creation time of this message
        example: 2016-02-23T21:28:58.556+0000
    required:
      - "@type"
      - creationTime
  BuddyMessage:
    allOf:
      - $ref: '#/definitions/Message'
    properties:
      nickname:
        type: string
        description: The nickname of the buddy
        example: RQ
      message:
        type: string
        description: The message from the buddy
        example: Hi there, how are you doing?
    required:
      - nickname
      - message
      - user
  BuddyMessageWithEmbeddedUser:
    allOf:
      - $ref: '#/definitions/BuddyMessage'
    properties:
      _embedded:
        type: object
        properties:
          "yona:user":
              $ref: "#/definitions/UserWithOnlyPublicData"
    required:
      - _embedded
  BuddyConnectRequestMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessageWithEmbeddedUser'
    properties:
      status:
        $ref: '#/definitions/BuddyStatus'
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/EditLink'
          - $ref: '#/definitions/AcceptLink'
          - $ref: '#/definitions/RejectLink'
    required:
      - status
      - _links
  BuddyConnectResponseMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessage'
    properties:
      status:
        $ref: '#/definitions/BuddyStatus'
        example: ACCEPTED
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/UserLink'
          - $ref: '#/definitions/EditLink'
          - $ref: '#/definitions/ProcessLink'
    required:
      - status
      - _links
  BuddyDisconnectMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessageWithEmbeddedUser'
    properties:
      dropBuddyReason:
        type: string
        enum:
          - USER_ACCOUNT_DELETED
          - USER_REMOVED_BUDDY
        description: The reason why this buddy is disconnected
        example: USER_REMOVED_BUDDY
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/EditLink'
          - $ref: '#/definitions/ProcessLink'
    required:
      - dropBuddyReason
      - _links
  GoalConflictStatus:
    type: string
    description: The status of this goal conflict message or disclosure request
    enum:
    - ANNOUNCED
    - DISCLOSURE_REQUESTED
    - DISCLOSURE_ACCEPTED
    - DISCLOSURE_REJECTED
  GoalConflictMessage:
    allOf:
      - $ref: '#/definitions/Message'
    properties:
      nickname:
        type: string
        description: The nickname of the buddy
        example: RQ
      status:
        $ref: '#/definitions/GoalConflictStatus'
        example: ANNOUNCED
      #TODO Add other properties of GoalConflictMessage
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/EditLink'
        properties:
          "yona:requestDisclosure":
            properties:
              href:
                type: string
                description: Post a MessageAction with a message property to accept this disclosure request
    required:
      - nickname
      - status
      - _links
  DisclosureRequestMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessage'
    properties:
      status:
        $ref: '#/definitions/GoalConflictStatus'
        example: DISCLOSURE_REQUESTED
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/UserLink'
          - $ref: '#/definitions/EditLink'
          - $ref: '#/definitions/RelatedLink'
          - $ref: '#/definitions/AcceptLink'
          - $ref: '#/definitions/RejectLink'
    required:
      - status
      - _links
  DisclosureResponseMessage:
    allOf:
      - $ref: '#/definitions/BuddyMessage'
    properties:
      status:
        $ref: '#/definitions/GoalConflictStatus'
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
          - $ref: '#/definitions/UserLink'
          - $ref: '#/definitions/EditLink'
          - $ref: '#/definitions/RelatedLink'
    required:
      - status
      - _links
  PagedMessages:
    type: object
    properties:
      _links:
        allOf:
          - $ref: '#/definitions/Curies'
          - $ref: '#/definitions/SelfLink'
        properties:
          next:
            properties:
              href:
                type: string
                description: Link to next page, if available
            required:
              - href
          self:
            properties:
              href:
                type: string
                description: Identifies this same resource
            required:
              - href
          prev:
            properties:
              href:
                type: string
                description: Link to previous page, if available
            required:
              - href
        required:
          - next
          - self
          - prev
      _embedded:
        properties:
          "yona:messages":
            type: array
            items:
              $ref: '#/definitions/Message'
      page:
        description: Information about the current page
        properties:
          size:
            type: string
            description: The number of elements on the current page
          totalElements:
            type: string
            description: The total number of elements
            example: 300
          totalPages:
            type: string
            description: The total number of pages
            example: 15
          number:
            type: string
            description: The current page number.
            example: 1
        required:
          - size
          - totalElements
          - totalPages
          - number
    required:
      - _links
      - _embedded
      - page
  MessageAction:
    type: object
    properties:
      "properties":
        type: object
        description: A set of properties to be passed to the message action
        additionalProperties:
          type: string
    required:
      - "properties"
  UserOverwriteRequest:
    type: object
    properties:
      mobileNumber:
        type: string
        description: The mobile number to be overwritten
        example: "+31612345678"
    required:
      - mobileNumber
  UserOverwriteResponse:
    type: object
    properties:
      confirmationCode:
        type: string
        description: The confirmation code that is to be used when overwriting the account. This code is only returned when the server is configured as test server. Normally, this code is sent to the user through SMS.
        example: 58947
  Error:
    type: object
    properties:
      code:
        type: string
        description: The error code
        example: error.user.mobile.number.invalid
      message:
        type: string
        description: A localized error message
        example: The mobile number ''+31 6 12345678'' is invalid. It must start with a + sign, with no spaces between the digits